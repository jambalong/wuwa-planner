<%# locals: (step:, plan_type:, subjects:, subject: nil, errors: nil) %>

<div class="search-container" data-controller="search-filter">
  <header class="modal-header">
    <h2 class="modal-title">Select
      <%= plan_type %>
    </h2>

    <%# Search Bar Interface %>
    <div class="search-field">
      <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="search-icon">
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="3"
          d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
        />
      </svg>

      <input
        type="text"
        data-search-filter-target="input"
        data-action="input->search-filter#filter"
        placeholder="Search by name..."
        class="search-input"
      >
    </div>
  </header>

  <%# Scrollable List Area %>
  <div class="subject-list custom-scrollbar">
    <% subjects.each do |subject_record| %>
      <div
        data-search-filter-target="subject"
        data-search-name="<%= subject_record.name %>"
      >
        <%= link_to new_plan_path(plan_type: plan_type, subject_id: subject_record.id, step: 3), 
            data: { turbo_frame: "modal" }, 
            class: "subject-item" do %>

          <div class="subject-info">
            <div class="subject-icon">
              <%= plan_type == "Resonator" ? "ðŸ‘¤" : "âš”ï¸" %>
            </div>
            <span
              class="subject-name <%= subject_record.rarity == 5 ? 'star-5' : 'star-4' %>"
            >
              <%= subject_record.name %>
            </span>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>

  <footer class="modal-footer">
    <%= link_to new_plan_path(step: 1), 
        data: { turbo_frame: "modal" },
        class: "modal-back-btn" do %>
      <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"/>
      </svg>
      Back
    <% end %>

    <span class="scroll-hint">Scroll for more</span>
  </footer>
</div>
